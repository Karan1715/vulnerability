<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/html">
<head>
    <title>Malicious URL Scanner Results</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='results.css') }}">
</head>
<body>
<div class ="mirror">
    <video playsinline autoplay muted loop poster="" id="bgvid">
        <source src="static/km_20230306_1080p_30f_20230306_193354.mp4" type="video/mp4">
    </video>
</div>
<div class="viewport">
    <h1>Malicious URL Scanner Results</h1>
    <table>
        <tr>
            <td colspan="3"><p class="big text-bold headerHR" style="overflow-wrap: break-word;">URL Scanning Details for {{ output.url }}</p></td>
        </tr>
        <tr>
            <td ><b>Safe:</b></td>
            <td class="space" ><small>Can this URL be trusted?</small></td>
            <td >
                {% if output.unsafe %}
                <font color="#FF3131">Warning - NOT SAFE</font>
                {% else %}
                <font color="#0FFF50">Clean URL - SAFE</font>
                {% endif %}
            </td>
        </tr>
        <tr>
            <td ><b>Suspicious:</b></td>
            <td class="space" ><small>Indicates reputation issues and potentially malicious activity.</small></td>
            <td >
                {% if output.suspicious %}
                <font color="#FF3131">Suspicious Activity</font>
                {% else %}
                <font color="#0FFF50">No Issues</font>
                {% endif %}
            </td>
        </tr>
        <tr>
            <td ><b>Domain:</b></td>
            <td class="space" ><small>Domain name of the final URL after all redirections.</small></td>
            <td ><b>{{ output.domain }}</b></td>
        </tr>
        <tr>
            <td ><b>IP Address:</b></td>
            <td class="space" ><small>The corresponding IP address for the URL's web server.</small></td>
            <td ><b>{{ output.ip_address }}</b></td>
        </tr>
        <tr>
            <td ><b>Country Code:</b></td>
            <td class="space" ><small>2 letter country code corresponding to the server's IP address.</small></td>
            <td >
                <b>{{ output.country_code }} <img width="24" alt="{{ output.country_code }}" src="/templates/img/icons/country-flags/{{ output.country_code|lower }}.svg" style="vertical-align: text-bottom;margin-left: 3px;"></b>
            </td>
        </tr>
        <tr>
            <td ><b>Malware:</b></td>
            <td class="space" ><small>Indicates if this domain has recently hosted malware, viruses, or C2 activity.</small></td>
            <td id="malware_result" >
                {% if output.malware %}
                <font color="#FF3131">Malicious Activity Detected</font>
                {% else %}
                <font color="#0FFF50">No Malware Detected</font>
                {% endif %}
            </td>

        </tr>
        <tr>
            <td ><b>Phishing:</b></td>
            <td class="space" ><small>Indicates if this site has been recently associated with known phishing techniques.</small></td>
            <td id="phishing_result" >
                {% if output.phishing %}
                <font color="#FF3131">Phishing Link</font>
                {% else %}
                <font color="#0FFF50">No Phishing Issues</font>
                {% endif %}
            </td>
        </tr>
        <tr>
            <td ><b>Risk Score:</b></td>
            <td class="space" ><small>Overall threat score from 0 (clean) to 100 (high risk).</small></td>
            <td >
                {% if output.risk_score == 0 %}
                <font color="#000000">{{ output.risk_score }} - Clean</font>
                {% elif output.risk_score < 65 %}
                <font color="#0FFF50">{{ output.risk_score }} - Low Risk</font>
                {% elif output.risk_score < 76 %}
                <font color="#e14b01">{{ output.risk_score }} - Suspicious</font>
                {% elif output.risk_score < 85 %}
                <font color="#dd4343">{{ output.risk_score }} - Risky</font>
                {% elif output.risk_score < 100 %}
                <font color="#dd4343">{{ output.risk_score }} - Very Risky</font>
                {% else %}
                <font color="#b91414">{{ output.risk_score }} - High Risk</font>
                {% endif %}
            </td>
        </tr>
        <tr>
            <td ><b>Domain Age:</b></td>
            <td class="space" ><small>Estimated age of domain, multiple formats available on API.</small></td>
            <td ><b>{{ output.domain_age }}</b></td>
        </tr>
        <tr>
            <td ><b>Parked Domain:</b></td>
            <td class="space" ><small>Is this domain currently parked?</small></td>
            <td >
                {% if output.parking %}
                <font color="#FF3131">Currently Parked</font>
                {% else %}
                <font color="#0FFF50">Not Parked</font>
                {% endif %}
            </td>
        </tr>
        <tr>
            <td ><b>Spamming:</b></td>
            <td class="space" ><small>Is this domain recently sending SPAM?</small></td>
            <td >
                {% if output.spamming %}
                <font color="#FF3131">Recent SPAM</font>
                {% else %}
                <font color="#0FFF50">No SPAM Issues</font>
                {% endif %}
            </td>
        </tr>
        <tr>
            <td ><b>Domain Category:</b></td>
            <td class="space" ><small>Category classification for content of website.</small></td>
            <td ><b>{{ output.category }}</b></td>
        </tr>
        <tr>
            <td ><b>HTTP Status Code:</b></td>
            <td class="space" ><small>Status code of the HTTP request. 200 is most common.</small></td>
            <td ><b>{{ output.status_code }}</b></td>
        </tr>
        <tr>
            <td ><b>Page Size:</b></td>
            <td class="space" ><small>Page size of URL's content in bytes.</small></td>
            <td >
                {% if output.page_size %}
                <b>{{ output.page_size }}</b>
                {% else %}
                N/A
                {% endif %}
            </td>
        </tr>
        <tr>
            <td ><b>Web Server:</b></td>
            <td class="space" ><small>Web server of URL's content.</small></td>
            <td >
                {% if output.server %}
                <b>{{ output.server }}</b>
                {% else %}
                N/A
                {% endif %}
            </td>
        </tr>
        <tr>
            <td ><b>Adult Content:</b></td>
            <td class="space" ><small>Is this domain hosting adult content?</small></td>
            <td >
                {% if output.adult %}
                <font color="#FF3131">Adult Content Detected</font>
                {% else %}
                <font color="#0FFF50">No Adult Content Found</font>
                {% endif %}
            </td>
        </tr>
    </table>
<ul>
    <tr>
        <td style="width:175px;padding: 10px 0 10px 0;"><b>Risk Score:</b></td>
        <td style="padding: 10px 0 10px 0;"></td>
        <td style="padding: 10px 0 10px 0;">
            {% if output.risk_score == 0 %}
            <font color="#000000">{{ output.risk_score }} - Clean</font>
            {% elif output.risk_score < 65 %}
            <font color="#0FFF50">{{ output.risk_score }} - Low Risk</font>
            {% elif output.risk_score < 76 %}
            <font color="#e14b01">{{ output.risk_score }} - Suspicious</font>
            {% elif output.risk_score < 85 %}
            <font color="#dd4343">{{ output.risk_score }} - Risky</font>
            {% elif output.risk_score < 100 %}
            <font color="#dd4343">{{ output.risk_score }} - Very Risky</font>
            {% else %}
            <font color="#b91414">{{ output.risk_score }} - High Risk</font>
            {% endif %}
        </td>
    </tr>

    <!-- Determine if it's safe to continue -->
     <!--<form  method="get" action="{{ url_for('sandbox_view', target_url=target_url) }}">-->
       <a href="{{ target_url }}" target="_blank"> <button id="continue_btn">Checking...</button> </a>
   <!-- </form>-->


    <script type="text/javascript">
    const malware_result = document.getElementById("malware_result").textContent.trim();
    const phishing_result = document.getElementById("phishing_result").textContent.trim();

    if (malware_result === "No Malware Detected" && phishing_result === "No Phishing Issues") {
        document.getElementById("continue_btn").innerHTML = "Safe to Continue";
        document.getElementById("continue_btn").style.backgroundColor = "#39FF14";
    } else if (malware_result === "No Malware Detected" || phishing_result === "No Phishing Issues") {
        document.getElementById("continue_btn").innerHTML = "Unsafe Suspicious";
        document.getElementById("continue_btn").style.backgroundColor = "#FF6700";
    } else {
        document.getElementById("continue_btn").innerHTML = "Unsafe to Continue";
         document.getElementById("continue_btn").style.backgroundColor = "#dd4343";
    }
    </script>
    <script>
    function redirectTo(target_url) {
        window.open(target_url, '_blank');
    }
    function redirectTo(target_url) {
            var iframe = document.getElementById("myIframe");
            iframe.src = target_url;
            iframe.style.display = "block";
            document.getElementById("continue_btn").style.display = "none";
    }
    </script>
</ul>
</div>
</body>
</html>
