<!DOCTYPE html>
<html>
<head>
  <title>OWASP ZAP Scan Results</title>
  <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='result.css') }}">
</head>
<body>
  <div class="container">
    <h1>OWASP ZAP Scan Results</h1>
    {% if summary %}
      <h2>Summary of Vulnerabilities</h2>
      <p>Total number of vulnerabilities found: {{ total }}</p>
      <ul>
        <li>High: {{ num_high }}</li>
        <li>Medium: {{ num_medium }}</li>
        <li>Low: {{ num_low }}</li>
      </ul>
      <table>
        <thead>
          <tr>
            <th>Source ID</th>
            <th>Method</th>
            <th>CWE ID</th>
            <th>WASC ID</th>
            <th>Description</th>
            <th>Confidence</th>
            <th>Solution</th>
          </tr>
        </thead>
        <tbody>
          {% for alert in alerts %}
            <tr class="{{ alert.confidence|lower }}">
              <td>{{ alert.sourceid }}</td>
              <td>{{ alert.method }}</td>
              <td>{{ alert.cweid }}</td>
              <td>{{ alert.wascid }}</td>
              <td>{{ alert.description }}</td>
              <td>{{ alert.confidence }}</td>
              <td>{{ alert.solution }}</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <h2>No Vulnerabilities Found</h2>
    {% endif %}
  </div>
</body>
</html>
