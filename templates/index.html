<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="This website is develop for identify the safety of url.">
    <meta name="keywords" content="phishing url,phishing,cyber security,machine learning,classifier,python">
    <meta name="author" content="VAIBHAV BICHAVE">

    <!-- BootStrap -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
        integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">

    <link href="static/style.css" rel="stylesheet">
    <title>URL detection</title>

</head>

<body>

<div class="main-body">
    <div class="form" id="form1">
        <H2>PHISHING URL DETECTION</H2>

    <br><br><br>
        <form action="/predict" method ="post">
            <input type="text" class="form__input" name ='target_url' id="target_url" placeholder="Enter URL" required="" />
            <label for="target_url" class="form__label">URL</label>
            <button class="button" role="button" >Check</button>
        </form>

        <br>
    <br>
    <p>Â©2023 Karan</p>
    </div>
    <div id="form2">

    <br>
    <h6 class = "right "><a href= {{ target_url }} target="_blank">{{ target_url }}</a></h6>

    <br>
    <h3 id="prediction"></h3>
    <button class="button2" id="button2" role="button" onclick="window.open('{{target_url}}')" target="_blank" >Still want to Continue</button>
    <button class="button1" id="button1" role="button"  onclick="window.open('{{target_url}}')" target="_blank">Continue</button>
    </div>
</div>
<div id="result"></div>



    <!-- JavaScript -->

    <script src="https://raw.githubusercontent.com/zaproxy/zap-api-python/main/src/zapv2.py"></script>
    <script>
      const form = document.getElementById('zap-form');
      form.addEventListener('submit', async (event) => {
        event.preventDefault();
        const url = document.getElementById('url-input').value;
        const zap = new Zapv2();
        const zapProxy = 'localhost:8080'; // Replace with the address of your ZAP proxy
        await zap.core.accessUrl(url);
        const spiderScanId = await zap.spider.scan(url);
        await zap.spider.purge(spiderScanId);
        const activeScanId = await zap.ascan.scan(url);
        await zap.ascan.purge(activeScanId);
        const alerts = await zap.core.alerts(url);
        const alertCount = alerts.length;
        const resultElement = document.getElementById('result');
        if (alertCount === 0) {
          resultElement.innerHTML = `The URL ${url} is safe.`;
        } else {
          resultElement.innerHTML = `The URL ${url} is unsafe. It has ${alertCount} alerts.`;
        }
      });
    </script>


</body>

</html>

